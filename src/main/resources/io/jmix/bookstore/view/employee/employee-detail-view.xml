<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<view xmlns="http://jmix.io/schema/flowui/view"
      title="msg://employeeDetailView.title"
      focusComponent="form">
    <data>
        <instance id="employeeDc"
                  class="io.jmix.bookstore.employee.Employee">
            <fetchPlan extends="_base">
                <property name="address" fetchPlan="_base"/>
                <property name="reportsTo" fetchPlan="_base"/>
                <property name="territories" fetchPlan="_base">
                    <property name="region" fetchPlan="_base"/>
                </property>
                <property name="user" fetchPlan="_base"/>
                <property name="position" fetchPlan="_base"/>
            </fetchPlan>
            <loader/>
            <collection id="territoriesDc" property="territories"/>
        </instance>
    </data>
    <facets>
        <dataLoadCoordinator auto="true"/>
    </facets>
    <actions>
        <action id="saveAction" type="detail_saveClose"/>
        <action id="closeAction" type="detail_close"/>
    </actions>
    <layout>
        <details opened="true" summaryText="msg://io.jmix.bookstore/demoInfo" themeNames="demo-info" width="100%">
            <html content="msg://employeeDetailView.demoInfo"/>
        </details>
        <tabSheet width="100%">
            <tab id="generalInfoTab" label="msg://generalInfoTab.label">
                <formLayout id="form">
                    <vbox>
                        <h5 text="msg://employeeDetailView.personalInformation"/>
                        <formLayout dataContainer="employeeDc" width="100%">
                            <select id="titleField" property="title"/>
                            <textField id="firstNameField" property="firstName"/>
                            <textField id="lastNameField" property="lastName"/>
                            <datePicker id="birthDateField" property="birthDate"/>
                            <entityPicker id="userField" property="user">
                                <actions>
                                    <action id="entityLookup" type="entity_lookup"/>
                                    <action id="entityClear" type="entity_clear"/>
                                </actions>
                            </entityPicker>
                        </formLayout>
                    </vbox>
                    <vbox>
                        <hbox alignItems="CENTER" width="100%">
                            <h5 text="msg://employeeDetailView.addressInformation"/>
                            <button id="showOnMapBtn" icon="MAP_MARKER" classNames="ms-auto"/>
                        </hbox>
                        <formLayout dataContainer="employeeDc" width="100%">
                            <textField id="addressStreetField" property="address.street"/>
                            <textField id="addressPostCodeField" property="address.postCode"/>
                            <textField id="addressCityField" property="address.city"/>
                            <textField id="addressStateField" property="address.state"/>
                            <textField id="addressCountryField" property="address.country"/>
                        </formLayout>
                    </vbox>
                </formLayout>
            </tab>
            <tab id="positionTab" label="msg://positionTab.label">
                <formLayout id="employeeForm" dataContainer="employeeDc">
                    <entityPicker property="position"/>
                    <datePicker id="hireDateField" property="hireDate"/>
                    <entityPicker id="reportsToField" property="reportsTo">
                        <actions>
                            <action id="entityLookup" type="entity_lookup"/>
                            <action id="entityClear" type="entity_clear"/>
                        </actions>
                    </entityPicker>
                    <datePicker property="probationEndDate"/>
                </formLayout>
            </tab>
            <tab id="territoriesTab" label="msg://territoriesTab.label">
                <vbox width="100%">
                    <hbox id="buttonsPanel" classNames="buttons-panel">
                        <button action="territoriesDataGrid.add"/>
                        <button action="territoriesDataGrid.exclude"/>
                    </hbox>
                    <dataGrid id="territoriesDataGrid" dataContainer="territoriesDc" width="100%" minHeight="20em">
                        <actions>
                            <action id="add" type="list_add"/>
                            <action id="exclude" type="list_exclude"/>
                        </actions>
                        <columns>
                            <column property="name"/>
                            <column property="region.name"/>
                        </columns>
                    </dataGrid>
                </vbox>
            </tab>
            <tab id="notesTab" label="msg://notesTab.label">
                <textArea id="notesField" height="9.5em" width="100%" dataContainer="employeeDc" property="notes" />
            </tab>
        </tabSheet>
        <hbox id="detailActions">
            <button id="saveAndCloseBtn" action="saveAction"/>
            <button id="closeBtn" action="closeAction"/>
        </hbox>
    </layout>
</view>
